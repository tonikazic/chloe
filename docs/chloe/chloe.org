# this is ../c/maize/docs/chloe/chloe.org

#+TITLE: Chloe: a System for Managing Maize Research Crops
#+AUTHOR: Toni Kazic
#+DATE: \today



* Overview

basic intro

Chloe is one of the many titles of Demeter, meaning ``young green shoot''.

insert flow and state diagrams here


* Dependencies and Cloud Services

** Software Requirements and Desirables

*** Required

Table [[reqd]] lists the software required: Perl, SWI Prolog, LaTeX, and GNU
barcode. Depending on your operating system, you may already have LaTeX and
applications that generate a postscript file from plain text (GNU Enscript)
and a pdf file from postscript (Ghostscript's ps2pdf).  The code assumes
Enscript and ps2pdf for complete command-line operation.

Prior versions ran under Perl 5.8 and Quintus Prolog.  This version has
been ported to Perl 5.26 and SWI Prolog, and should remain compatible with
all future releases of those languages (but not Perl 6, AFAIK).


*nb: Prolog files have the .pl extension.  Perl files have the .perl and
.pm extensions.* I started writing in Prolog first and that is the Prolog
convention.  Prolog files generated by org mode's export function have a
.prolog extension.


I personally prefer the [[https://www.tug.org/texlive/acquire-netinstall.html][TeXLive]] distribution for cross-platform
compatibility and use that on my Macs, rather than other packagings.
However, I am lazy enough to use the [[https://emacsformacosx.com/][packaged binary for Emacs]] for the
Macs. 


I have tested several spreadsheet apps over the years, but keep coming back
to Apple's Numbers.  A good spreadsheet app for data collection must do nine
things:
   + minimize the time spent collecting the data;
   + permit text entry via bluetooth barcode scanner;
   + permit easy time-stamping of a single entry *without changing the
     timestamps of other entries* (something Google Sheets doesn't do);
   + permit convenient data entry tools, such as customizable drop-down
     menus and data formats; 
   + permit download and use while off-line;
   + permit easy navigation around the spreadsheet when using the data
     collection device of your choise; 
   + sync to your cloud file service *without dumping data if the
     connection is lost*; and
   + export a .csv file.

Being able to run the spreadsheet on both the desktop and the mobile device
is highly desirable.  I pre-fill the spreadsheet with the day's defaults as
much as possible before going to the field.


One can scan text directly into an org file, but AFAIK something like
drop-down menus are not supported.

#+name: reqd
#+caption:  Required software.
| language or package          | version                          | code assumes binary dirs                | comments                                               |
|------------------------------+----------------------------------+-----------------------------------------+--------------------------------------------------------|
| [[https://www.perl.org/][Perl]]                         | 5.26.1 and later                 | /opt/perl5/perls/perl-5.26.1/bin/perl   | any version later than 5.10 should work                |
|                              |                                  |                                         | recommend [[https://perlbrew.pl/][PerlBrew]]                                     |
| [[http://www.swi-prolog.org][SWI Prolog]]                   | 7.6.4 and later                  | /Applications/SWI-Prolog (Mac-specific) | earlier versions should also work                      |
| [[https://ctan.org/?lang=en][LaTeX]]                        | 3.14159265-2.6-1.40.19 and later | /usr/local/texlive/YEAR/bin             | any version within the last ten years should work,     |
|                              |                                  |                                         | but recommend the latest [[https://www.tug.org/texlive/acquire-netinstall.html][TeXLive]] distribution          |
| [[https://www.gnu.org/software/barcode/][GNU barcode]]                  | 0.99                             | /opt/local/bin                          |                                                        |
| Numbers or other spreadsheet |                                  | /Applications/Numbers (Mac-specific)    | beware global changes when timestamps are inserted     |




*** Highly Desireable

Table [[desirable]] lists packages and applications I use routinely in the
field and office.  In this context, Emacs is *highly* desirable because it
supports [[https://orgmode.org/][org mode]] and its export, table, and project management
facilities.  I have not yet spent the time needed to configure org tables
for data collection, and would welcome help on this!

I have found [[https://beorgapp.com/][beorg]] excellent for taking quick notes in the field,
especially to-do lists and revisions to the database based on observations
or unplanned events.  In my hands, it is more robust than [[https://orgmode.org/manual/MobileOrg.html][MobileOrg]].  I
have not experimented with Android devices.

The code generates pedigrees and a field book in pdf, which it copies to
the Dropbox directories for syncing to the mobile device.  I directly
annotate the field book pdf with observations and changes, then edit the
source database files with the new information and regenerate the field book.  I have
experimented with several pdf annotation apps over the years, but have
found iAnnotate to be more robust and easier to use in the field than Adobe
Acrobat.  

#+name: desirable
#+caption:  Highly desirable software, depending on your workflow.
| language or package          | version                          | code assumes binary dirs                | comments                                               |
|------------------------------+----------------------------------+-----------------------------------------+--------------------------------------------------------|
| [[https://www.gnu.org/software/emacs/][GNU Emacs]]                    | 25.1 or later                    | /Applications/Emacs (Mac-specific)      | any version with org 8.2.10+ should work               |
|                              |                                  |                                         | for Macs, I recommend [[https://emacsformacosx.com/][Emacs for Mac OS X]]               |
| [[https://beorgapp.com/][beorg]]                        | 2.0                              | iPhone/iPad only                        | for jotting down quick notes in the field;             |
|                              |                                  |                                         | syncs to Dropbox and other cloud services.             |
|                              |                                  |                                         | I have no experience with Android org apps.            |
| [[https://www.gnu.org/software/enscript/][GNU Enscript]]                 | 1.6.6 or later                   | /usr/local/bin                          | any version within the last ten years should work      |
| [[https://www.ghostscript.com/][Ghostscript]]                  | 8.71                             | /opt/local/bin                          | for ps2pdf; get the latest version                     |
| [[https://www.iannotate.com/][iAnnotate]]                    | 4+                               | iPhone/iPad only                        | for annotating field book in the field;                |
|                              |                                  |                                         | edit files inside with important changes, \eg, [[file../demeter/data/plan.pl][plan.pl]] |
|                              |                                  |                                         | syncs to Dropbox and other cloud services              |
|                              |                                  |                                         | other mobile PDF readers that sync should work         |


** Cloud Services

We use [[https://www.dropbox.com/][Dropbox]] for syncing spreadsheets to and from the devices used in the
field.  Others can be used as long as they connect to the desirable apps you
want to use.


** Data Collection Devices

   + barcode scanner:  [[https://www.koamtac.com/bluetooth-barcode-scanners/kdc200-bluetooth-barcode-scanner/][KoamTac KDC200i]]
   + mobile data collection platforms: We use iPad2, the iPad mini, and an
     iPhone 5S.  The iPhone is handiest for one-person operations.




* Installation

** Installation

Install the essentials


** Directory Structure


** Configuration for Your System



1.  modify [[file:../../label_making/Typesetting/DefaultOrgztn.pm][DefaultOrgztn.pm]] for your directory scheme and record-keeping
    conventions 


2.  check all Perl regex lines by grepping
#
#+BEGIN_SRC 
grep '=~' *.perl
#+END_SRC
#
to ensure:
   + the order of the arguments matches the order of the fields in your
     spreadsheets
   + the regular expressions match your conventions.  Nearly all regexs are
     in [[file:../../label_making/Typesetting/MaizeRegEx.pm][MaizeRegEx.pm]], but a few defined on the fly have crept into the code.


* Usage



** Data Collection Procedures


** Crop Planning


** Crop Management

