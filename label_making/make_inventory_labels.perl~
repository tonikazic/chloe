#!/usr/bin/perl

# this is ../maize/label_making/make_inventory_labels.perl

# generate labels to go on the boxes and the sleeves.  The boxes are
# 10-up labels, the sleeves 30-up labels.  Each one is a separate set of
# routines, activated by a call from the command line.
#
# call for boxes is make_inventory_labels.perl i x STARTBOX ENDBOX 
#
# call for sleeves is make_inventory_labels.perl i v STARTSLEEVE ENDSLEEVE
#
# call for bags is make_inventory_labels.perl i a STARTBAG ENDBAG
#
# call for pots is make_inventory_labels.perl i t STARTPOT ENDPOT
#
# Kazic, 26.9.07
#
# added pots to prevent future greenhouse confusion
#
# Kazic, 14.1.08


use Typesetting::DefaultOrgztn;
use Typesetting::OrganizeData;
use Typesetting::TypesetGenetics;
use Typesetting::TypesettingMisc;
use Typesetting::GenerateOutput;



# don't know why I must repeat assignment of $crop here; this is in DefaultOrgztn.pm
#
# Kazic, 6.11.07

$crop = $ARGV[0];
$type = $ARGV[1];
$start = $ARGV[2];
$stop = $ARGV[3];




if ( $type eq "x" ) { $file_stem = "box_labels"; }
elsif ( $type eq "v" ) { $file_stem = "sleeve_labels"; }
elsif ( $type eq "a" ) { $file_stem = "bag_labels"; }
elsif ( $type eq "t" ) { $file_stem = "pot_labels"; }


$output = $output_dir . $file_stem . $tex_suffix;






# master list of boxes, their crops, maternal lines, and comments
# check this against actual boxes and correct as needed
#
# I'm NOT worrying about the year 2100 problem ;-)!

%boxes = (   0 => 'fdtnl::seed gifts,;;06R, 06N inbreds;;bags 1--8',
             1 => '06R::Mo20W mutants,;; inbreds;;sleeves 1--7',
             2 => '06R::Mo20W, W23;;mutants, inbreds;;sleeves 8--14',
             3 => '06R::W23, M14 mutants,;; inbreds;;sleeves 15--21',
             4 => '06R::M14 mutants,;;inbreds, Gerry hets,;;MGCSC sibs;;sleeves 22--28',
             5 => '06N::Mo20W lines;;sleeves 29--35',
             6 => '06N::Mo20W lines;;sleeves 36--42',
             7 => '06N::Mo20W lines;;sleeves 43--48',
             8 => '06N::W23 lines;;sleeves 49--55',
             9 => '06N::W23 lines;;sleeves 56--62',
            10 => '06N::W23 lines;;sleeves 63--69',
            11 => '06N::W23, M14 lines;;sleeves 70--76',
            12 => '06N::M14 lines;;sleeves 77--83',
            13 => '07R::Mo20W lines;;sleeves 84--90',
            14 => '07R::Mo20W lines;;sleeves 91--97',
            15 => '07R::Mo20W, W23 lines;;sleeves 98--104',
            16 => '07R::W23 lines;;sleeves 105--111',
            17 => '07R::W23, M14 lines;;sleeves 112--118',
            18 => '07R::M14 lines;;sleeves 119--125',
            19 => '07R::M14 lines, selfs;;sleeves 126--132',
            20 => 'next box!',
         99998 => '50r::W;;sleeves --',
         99999 => '99n::S;;sleeves --' ); 



(@labels) = &make_inventory_labels($type,$start,$stop,$crop,\%boxes);




open(TAG,">$output");

&begin_small_label_latex_file(\*TAG);


# nb:  picture not closed properly, but file runs ok
#
# Kazic, 17.6.09

for ( $i = 0; $i <= $#labels; $i++ ) {
        ($type,$barcode_out,$crop,$box,$comment,$sleeve) = split(/::/,$labels[$i]);
        if ( $type eq "x" ) { &print_box_label(\*TAG,$barcode_out,$box,$crop,$comment,$i,$#labels); }
        elsif ( $type eq "v" ) { &print_sleeve_label(\*TAG,$barcode_out,$sleeve,$i,$#labels); }
        elsif ( $type eq "a" ) { &print_sleeve_label(\*TAG,$barcode_out,$sleeve,$i,$#labels); }
        elsif ( $type eq "t" ) { &print_pot_label(\*TAG,$barcode_out,$sleeve,$i,$#labels); }
        }

&end_latex_file(\*TAG);


close(TAG);


&generate_pdf($output_dir,$file_stem,$ps_suffix,$pdf_suffix);





